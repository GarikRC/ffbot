## FFbot alpha ##

Представляю Вам свою поделку под названием FFbot. Это jabber- и ICQ-бот, поддерживающий разные плагины (a.k.a. протоколы).

На этой странице будет актуальная для последней версии документация.

## Общая информация ##

**FFBot**: IM-бот, поддерживающий разные протоколы (в качестве модулей)
Copyright (C) 2009 **Slaff**
http://sbira.org.ru/

**FFBot** - это свободное ПО. Вы можете его без каких-либо ограничений использовать, распространять и модифицировать его по правилам BSD-лицензии.

**FFBot** распространяется бесплатно, и Вы его используете на свой страх и риск. Автор не несёт ответственности за  любой вред, причинённый данным скриптом.

Я (автор) с радостью приму любые пожелания, благодарности, обоснованную критику. Это всё Вы можете высказать на моём личном блоге или лично мне в ICQ **8340217**, jabber **sbira@jabber.ru**, e-mail **sbir@bk.ru**.

**ВНИМАНИЕ!!! Это alpha-версия.** В ней возможны куча багов при минимальном количестве функций. Отнеситесь к этому с пониманием. Все обновления можно скачать на этой страничке.

Этот бот не работает с **QIP 2005** и **QIP Infium** (если бот у Вас в контакт-листе), т.к. квипы посылают сообщения в UTF8, а бот обрабатывает их как cp1251. Хз почему.

Предупреждаю сразу - версии будут выходить редко, но сразу с большими нововведениями

## Changelogs ##
v0.11
  * Изменилась структура плагинов (из-за этого и выпускалась версия v0.11). Чтобы не запутаться
  * Добавлена команда !ребут

## Как запускать ##

  * Распаковываем файлы в папку на Вашем сервере.
  * Открываем файл `протокол_c.php` блокнотом, вводим настройки.
  * Открываем `протокол.php` в браузере, вводим имя плагина и тыкаем “Поехали”. На адрес администратора должно прийти уведомление об успешном запуске бота.

## Описание файлов ##

  * **icq.php** - модуль для работы с ICQ-протоколом.
  * **icq.php** - модуль для работы с ICQ-протоколом.
  * **icq\_c.php** - настройки ICQ-модуля.
  * **jabber.php** - модуль для работы с XMPP-протоколом.
  * **jabber\_c.php** - настройки jabber-модуля.
  * **bot\_utf8.php** - ядро бота в кодировке UTF-8.
  * **bot\_1251.php** - ядро бота в кодировке CP1251.
  * **readme.txt** - собственно, само описание.

## Порядок создания модуля для своего протокола ##
### Файл самого протокола (протокол.php) ###
```
/* Вставка файлов для работы с php-классом */
  require 'bot_*.php'; // Вставка ядра, где * - это 1251 или utf8.
/* Объявление IM-класса и подключение к протоколу */
  function send($to, $text) // Функция отправки сообщения, где $bot - это
                            // переменная подключения
  {
    global $bot;
    $bot->send($to, $text); // Отправка сообщения через Ваш php-класс
  }
  send($admin, 'Я запущен'); // Уведомление администратора
  while ($exit)
  {
    /* Получение сообщений */
    obr($text, $from); // Обработка сообщения, где $text - это текст сообщения,
                       // а $from - это адрес, с которого пришло сообщение
    sleep(1); // Подремать секунду
  }
  $bot->disconnect();
```
### Файл настройки (протокол\_c.php) ###
`/* Этот файл содержит объявления констант настроек */`

## Команды бота ##

На данный момент у бота реализованы следующие пользовательские команды:

  * **!о боте** - думаю понятно
  * **!админу 'текст'** - связь с администратором
  * **!отправить 'кому'/'что'** - отправить на адрес “кому” текст “что”
  * **!айбаш** - случайная цитата с ibash.org.ru

И администраторские (т.е. которые доступны только администратору):

  * **!стоп** - остановка бота
  * **!ребут** - перезагрузка
  * **!ответ 'кому'** - сообщение на адрес “кому” от имени администратора

## Примечания ##

Опытным программистам могут показаться некоторые вещи глупыми. А именно:

  * **Зачем в файле протокола надо объявлять функцию `send()` ?** Ответ прост: чтобы сделать файл ядра независимым от плагинов.
  * **Зачем вообще сделана эта возможность добавления плагинов, ведь бот ещё не распространился, чтобы для него писали эти модули?** Эту возможность я сделал в первую очередь для себя, чтобы в любой момент можно было перенести протокол на другой PHP-класс и добавить ещё один протокол.